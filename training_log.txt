========================================================================================================================
EXTRACTION DES DONNÉES HISTORIQUES
========================================================================================================================

Chargement des données...
Erreur requête initiale: Execution failed on sql '
SELECT
    nom_norm,
    race_key,
    annee,
    hippodrome_code,

    -- Target
    CASE WHEN place_finale <= 3 THEN 1 ELSE 0 END as target_place,
    is_win::int as target_win,
    place_finale,

    -- Cotes
    cote_reference,
    cote_finale,

    -- Course
    discipline,
    distance_m,
    numero_dossard,

    -- Cheval
    age,
    sexe,
    poids_kg,
    handicap_distance,

    -- Conditions
    etat_piste,
    meteo_code,
    temperature_c,
    vent_kmh,

    -- Stats historiques si disponibles
    musique_last_5,
    total_gains_euros,
    nombre_victoires,
    nombre_places,
    taux_reussite,

    -- Jockey/Driver
    driver_jockey,
    entraineur

FROM cheval_courses_seen
WHERE cote_reference IS NOT NULL
  AND cote_reference > 0
  AND place_finale IS NOT NULL
  AND annee >= 2023
ORDER BY race_key ASC
': column "musique_last_5" does not exist
LINE 35:     musique_last_5,
             ^


Essai avec requête minimale...
✓ 291,929 courses chargées
  32,994 courses uniques
  Placés: 91,380 (31.3%)
  Gagnants: 30,830 (10.6%)

========================================================================================================================
PRÉPARATION DES FEATURES
========================================================================================================================
✓ 10 features: ['cote_reference', 'cote_finale', 'distance_m', 'age', 'cote_log', 'cote_drift', 'discipline_enc', 'sexe_enc', 'hippodrome_code_enc', 'categorie_cote_enc']

========================================================================================================================
SPLIT TEMPOREL
========================================================================================================================
Train: 281,016 courses
Val:   9,089 courses
Test:  1,824 courses

========================================================================================================================
ENTRAÎNEMENT DES MODÈLES
========================================================================================================================

[1/3] XGBoost...
  ❌ XGBClassifier.fit() got an unexpected keyword argument 'early_stopping_rounds'

[2/3] LightGBM...
  ❌ No module named 'lightgbm'

[3/3] CatBoost...
  ❌ No module named 'catboost'

========================================================================================================================
RÉSULTATS
========================================================================================================================

Modèle          Val AUC      Test AUC
----------------------------------------
Traceback (most recent call last):
  File "/Users/gicquelsacha/horse3/train_model_simple.py", line 315, in <module>
    best_name = max(results.keys(), key=lambda k: results[k]['test_auc'])
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: max() arg is an empty sequence
